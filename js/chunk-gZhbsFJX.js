import{d as e,u as a,s as l,r as t,a as o,b as r,x as n,p as s,t as i,j as p,D as d,a8 as b,a6 as c,a7 as m,o as u}from"./chunk-7McyaHaY.js";import{_ as g}from"./chunk-C2aLKJYZ.js";import{u as v,i as f}from"./chunk-BhGQo3Ao.js";const y={class:"overflow-y-auto"},z={class:"flex items-center justify-start gap-10"},N={class:"flex flex-col"},A={class:"form-control"},k={class:"cursor-pointer label"},h={class:"label-text"},x=e({__name:"PersonAlready",setup(e){const{t:x}=a(),T=v().personConfig,{getAlreadyPersonList:j,getAlreadyPersonDetail:C}=l(T),_=t(!1);function P(e){T.moveAlreadyToNot(e)}function S(){let e=JSON.parse(JSON.stringify(C.value));for(let l=0;l<e.length;l++)delete e[l].x,delete e[l].y,delete e[l].id,delete e[l].createTime,delete e[l].updateTime,delete e[l].prizeId,delete e[l].prizeGroupId,delete e[l].prizeGroupName,delete e[l].avatar,delete e[l].isWin,e[l].prizeTime=e[l].prizeTime.join(","),e[l].prizeName=e[l].prizeName.join(",");let a=JSON.stringify(e);if(a=a.replaceAll(/uid/g,f.global.t("data.number")).replaceAll(/contact/g,f.global.t("data.contact")).replaceAll(/isWin/g,f.global.t("data.isWin")).replaceAll(/department/g,f.global.t("data.department")).replaceAll(/name/g,f.global.t("data.name")).replaceAll(/identity/g,f.global.t("data.identity")).replaceAll(/prizeName/g,f.global.t("data.prizeName")).replaceAll(/prizeTime/g,f.global.t("data.prizeTime")).replaceAll(/voteCount/g,f.global.t("data.voteCount")),e=JSON.parse(a),e.length>0){const a=c.json_to_sheet(e),l=c.book_new();c.book_append_sheet(l,a,"Sheet1"),m(l,"获奖人员名单.xlsx")}}const w=[{label:f.global.t("data.number"),props:"uid",sort:!0},{label:f.global.t("data.name"),props:"name"},{label:f.global.t("data.contact"),props:"contact",sort:!0},{label:f.global.t("data.voteCount"),props:"voteCount"},{label:f.global.t("data.prizeName"),props:"prizeName",sort:!0},{label:f.global.t("data.operation"),actions:[{label:f.global.t("data.removePerson"),type:"btn-info",onClick:e=>{P(e)}}]}],J=[{label:f.global.t("data.number"),props:"uid",sort:!0},{label:f.global.t("data.name"),props:"name"},{label:f.global.t("data.contact"),props:"contact",sort:!0},{label:f.global.t("data.prizeName"),props:"prizeName",sort:!0},{label:f.global.t("data.prizeTime"),props:"prizeTime"},{label:f.global.t("data.operation"),actions:[{label:f.global.t("data.removePerson"),type:"btn-info",onClick:e=>{P(e)}}]}];return(e,a)=>(u(),o("div",y,[r("h2",null,i(p(x)("viewTitle.winnerManagement")),1),r("div",z,[r("button",{class:"btn btn-accent btn-sm",onClick:S},i(p(x)("button.exportResult")),1),r("div",null,[r("span",null,i(p(x)("table.luckyPeopleNumber"))+"：",1),r("span",null,i(p(j).length),1)]),r("div",N,[r("div",A,[r("label",k,[r("span",h,i(p(x)("table.detail"))+":",1),d(r("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>_.value=e),type:"checkbox",class:"border-solid toggle toggle-primary border-1"},null,512),[[b,_.value]])])])])]),_.value?s("",!0):(u(),n(g,{key:0,"table-columns":w,data:p(j)},null,8,["data"])),_.value?(u(),n(g,{key:1,"table-columns":J,data:p(C)},null,8,["data"])):s("",!0)]))}});export{x as default};
