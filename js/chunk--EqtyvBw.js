import{u as e,g as a}from"./chunk-BhGQo3Ao.js";import{a as s}from"./chunk-Dv7RK_ed.js";import{d as t,u as l,s as n,r,l as i,h as o,w as u,a as c,b as m,p as d,t as v,j as p,F as g,A as f,m as h,o as b}from"./chunk-7McyaHaY.js";const k={class:"toast toast-top toast-end"},y={key:0,class:"alert alert-error"},w={key:1,class:"alert alert-success"},I={key:2,class:"alert alert-error"},x={class:""},C={for:"explore"},S=["accept"],j={class:"btn btn-primary btn-sm"},F={class:"p-0"},T={class:"flex items-center gap-8"},$={class:"avatar h-14"},_={class:"w-12 h-12 mask mask-squircle hover:w-14 hover:h-14"},q={class:"w-64"},A={class:"overflow-hidden font-bold whitespace-nowrap text-ellipsis"},D=["onClick"],L=t({__name:"ImageConfig",setup(t){const{t:L}=l(),N=e().globalConfig,{getImageList:U}=n(N),z=r("image/*"),B=r(0),E=i.createInstance({name:"imgStore"});async function G(e){if(!/image*/.test(e.target.files[0].type))return void(B.value=3);const{dataUrl:a,fileName:t}=await s(e.target.files[0]);E.setItem(`${(new Date).getTime().toString()}+${t}`,a).then(()=>{B.value=1,async function(){(await E.keys()).length>0&&E.iterate((e,a)=>{N.addImage({id:a,name:a,url:"Storage"})})}()}).catch(()=>{B.value=2})}return o(()=>{}),u(()=>B.value,e=>{0!==e&&setTimeout(()=>{B.value=0},2e3)}),(e,s)=>(b(),c(g,null,[m("div",k,[2===B.value?(b(),c("div",y,[m("span",null,v(p(L)("error.uploadFail")),1)])):d("",!0),1===B.value?(b(),c("div",w,[m("span",null,v(p(L)("error.uploadSuccess")),1)])):d("",!0),3===B.value?(b(),c("div",I,[m("span",null,v(p(L)("error.notImage")),1)])):d("",!0)]),m("div",null,[m("div",x,[m("label",C,[m("input",{id:"explore",type:"file",class:"",style:{display:"none"},accept:z.value,onChange:G},null,40,S),m("span",j,v(p(L)("button.upload")),1)])]),m("ul",F,[(b(!0),c(g,null,f(p(U),e=>(b(),c("li",{key:e.id,class:"mb-3"},[m("div",T,[m("div",$,[m("div",_,[h(a,{"img-item":e},null,8,["img-item"])])]),m("div",q,[m("div",A,v(e.name),1)]),m("div",null,[m("button",{class:"btn btn-error btn-xs",onClick:a=>function(e){"Storage"===e.url&&E.removeItem(e.id).then(()=>{N.removeImage(e.id)}),N.removeImage(e.id)}(e)},v(p(L)("button.delete")),9,D)])])]))),128))])])],64))}});export{L as default};
